{
  "type": "webhook",
  "name": "create_booking",
  "description": "Create a new transfer booking in the system. This will automatically create the booking in the database, generate a Stripe payment checkout link, and send a confirmation email with the payment link to the customer. CRITICAL: Only call this tool after you have confirmed ALL booking details with the customer and received explicit confirmation to proceed. Required information: customer name, email, phone, pickup location, dropoff location, date and time, vehicle selection, and total price.",
  "disable_interruptions": true,
  "force_pre_tool_speech": "force",
  "assignments": [],
  "tool_call_sound": null,
  "tool_call_sound_behavior": "auto",
  "execution_mode": "post_tool_speech",
  "api_schema": {
    "url": "https://gwlaxeonvfywhecwtupv.supabase.co/functions/v1/elevenlabs-create-booking",
    "method": "POST",
    "path_params_schema": [],
    "query_params_schema": [],
    "request_body_schema": {
      "id": "body",
      "type": "object",
      "description": "Extract all booking information from the conversation after customer confirmation. Required: customer name, email, pickup location, dropoff location, pickup datetime, vehicle selection, total price, and trip type. Optional: phone, flight number, special requests.",
      "properties": [
        {
          "id": "customer_name",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Full name of the customer (first and last name)",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "customer_email",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Email address of the customer (must be valid email format). The payment link and booking confirmation will be sent to this email.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "customer_phone",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Phone number with country code (e.g., '+1 555-123-4567'). Optional but recommended.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": false
        },
        {
          "id": "pickup_location",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Detailed pickup location (e.g., 'Punta Cana International Airport (PUJ)', 'Hard Rock Hotel Punta Cana')",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "dropoff_location",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Detailed dropoff location (e.g., 'Dreams Cap Cana Resort', 'Santo Domingo Airport (SDQ)')",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "pickup_datetime",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "ISO 8601 datetime for pickup (e.g., '2024-12-25T14:30:00Z'). Include timezone. Ask the customer for their arrival date and time.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "passengers",
          "type": "number",
          "value_type": "llm_prompt",
          "description": "Number of passengers traveling (default: 1)",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": false
        },
        {
          "id": "vehicle_type_id",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "ID of the selected vehicle type from calculate_quote response (e.g., vehicle_id from the quote). This is required to track which vehicle was selected.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": false
        },
        {
          "id": "vehicle_name",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Name of the selected vehicle from the quote (e.g., 'Sedan', 'SUV', 'Minivan', 'Suburban')",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "flight_number",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Flight number if pickup is from airport (e.g., 'AA1234', 'DL5678'). Optional - only ask if pickup is from an airport.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": false
        },
        {
          "id": "special_requests",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Any special requests, notes, or requirements from the customer (e.g., 'Need child seat', 'Wheelchair accessible', 'Extra luggage space'). Optional.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": false
        },
        {
          "id": "total_price",
          "type": "number",
          "value_type": "llm_prompt",
          "description": "Total price in USD from the calculate_quote response (e.g., 50.00). This exact amount will be charged via Stripe.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "trip_type",
          "type": "string",
          "value_type": "llm_prompt",
          "description": "Type of trip: 'one_way' or 'round_trip'. Must match what was used in the quote.",
          "dynamic_variable": "",
          "constant_value": "",
          "enum": null,
          "is_system_provided": false,
          "required": true
        },
        {
          "id": "source",
          "type": "string",
          "value_type": "constant",
          "description": "Source of the booking - always set to 'elevenlabs_voice_agent'",
          "dynamic_variable": "",
          "constant_value": "elevenlabs_voice_agent",
          "enum": null,
          "is_system_provided": false,
          "required": true
        }
      ],
      "required": false,
      "value_type": "llm_prompt"
    },
    "request_headers": [
      {
        "type": "value",
        "name": "Content-Type",
        "value": "application/json"
      }
    ],
    "auth_connection": null
  },
  "response_timeout_secs": 30,
  "dynamic_variables": {
    "dynamic_variable_placeholders": {}
  }
}
